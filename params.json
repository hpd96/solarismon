{"name":"Solarismon","tagline":"Simple RaspberryPi based Rotex Solaris RPS3 solar heating system monitor","body":"# solarismon\r\n\r\nSimple RaspberryPi based Solaris RPS3 Solar Heating System Monitor\r\n---\r\nThe goal of this project is to monitor the behavior and afterwards optimize the settings of a Rotex Solaris RPS3 solar \r\nheating system with the least possible efforts.\r\n\r\nTherefore a few existing hardware and software components and an already up and running linux home server where utilized.\r\n### Components\r\n- a **[RaspberryPi](https://www.raspberrypi.org/)** receives the serial output of the Rotex Solaris control unit \r\n(CONF connector, 3.5mm stereo jack).\r\n- a **JavaScript** program running on the Pi, handles the data, does some simple conversions, writes the data to \r\nlog files and finally generates a **[MQTT] (http://mqtt.org)** message for every received measurement \r\n- this MQTT message is transferred to a **[Mosquitto](http://mosquitto.org/)** MQTT broker  running on the linux home server.\r\n- an **[OpenHAB] (http://www.openhab.org/)** home automation server running on the same linux box is configured to receive the \r\nMQTT messages. It is the task of openHAB to store the measured values in a round robin database and to visualize them. \r\nThe openHAB server is accessible via a browser in the local network, but nice smartphone client apps for android and iOS are available as well.\r\n\r\n\r\nI'm pretty sure that it would be possible to run the openHAB and the mosquitto MQTT broker on the RasberryPi also, but installing them on the available\r\nlinux box with less limited resources than the Pi was promising less efforts in installation.\r\n\r\n### Hints\r\n\r\n1. **Serial Connection:** \r\n The three contacts of the 3.5mm stereo jack are:\r\n * `Tip:    Solaris TX       connected to RX of the RaspberryPi`\r\n * `Ring:   Solaris RX       not used`\r\n * `Sleeve: GND              connected to GND of the RaspberryPi` \r\n \r\n The serial voltage level used by the Solaris heating system controller panel is 5V, whereas the RaspberryPi uses 3.3V. Hence a [level shifter](http://elinux.org/RPi_GPIO_Interface_Circuits#Level_Shifters) \r\n is needed. In my case, a simple [2 resistor voltage divider](http://elinux.org/RPi_GPIO_Interface_Circuits#Voltage_divider) works fine. Activate the Solaris data output of the RPS3 module as described in the rotex manual. I selected a transfer interval \r\n of 30s and a baudrate of 19200.\r\n\r\n2. **Node.js init script:**\r\nIf you want to have your Node.js application automatically started on every RaspberryPi reboot, an init script\r\nlike this one https://gist.github.com/peterhost/715255 may be used.  \r\nSince */bin/sh* is a softlink to */bin/dash* on my Raspbian linux, the script did not work as expected, so I had to replace\r\n*#!/bin/sh* with *#!/bin/bash* in the first line of the script.\r\n\r\n3. **openHAB configuration:**  \r\nSome example openHAB configuration files (items, persistence, sitemaps) are located unter the \"openhab\" directory in this repository. They define items (measurement values), their graphical representation in the openHAB clients and their persistence strategy.\r\nDon't forget to activate and configure the MQTT binding, as described in the [openHAB configuration wiki](https://github.com/openhab/openhab/wiki/MQTT-Binding). For me, changing / uncommenting the following two lines of `OPENHAB_HOME/configurations/openhab.cfg` was sufficient.\r\n\r\n        mqtt:tux.url=tcp://tux.home:1883\r\n        mqtt:tux.clientId=openHAB\r\n\r\n### Screenshots\r\nA few openHAB screenshots\r\n![](/images/openHAB-screen1.jpg?raw=true)\r\n![](/images/openHAB-screen2.jpg?raw=true)\r\n\r\n### Images\r\n\r\nHere are some images of the installation of the Raspberry pi into the Rotex Solaris Console:\r\n![](/images/IMG_0480.jpg?raw=true)\r\n![](/images/IMG_0481.jpg?raw=true)\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}